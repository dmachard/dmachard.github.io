<!doctype html><html lang=en-US><head><meta charset=utf-8><meta name=viewport content="width=device-width"><link rel=stylesheet href=https://dmachard.github.io/css/primer/core.min.css><link rel=stylesheet href=https://dmachard.github.io/css/primer/product.min.css><title>Posts - My technical gists</title><link rel=icon type=image/x-icon href=/images/avatar.png><meta name=theme-color content="#1e2327"><meta name=description content><meta name=keywords content="blog,technical"><meta name=robots content="noodp"><link rel=canonical href=https://dmachard.github.io/posts/><meta name=twitter:card content="summary"><meta name=twitter:title content="Posts - My technical gists"><meta name=twitter:description content><meta name=twitter:site content="https://dmachard.github.io/"><meta name=twitter:creator content><meta name=twitter:image content="https://dmachard.github.io/"><meta property="og:type" content="website"><meta property="og:title" content="Posts - My technical gists"><meta property="og:description" content><meta property="og:url" content="https://dmachard.github.io/posts/"><meta property="og:site_name" content="Posts"><meta property="og:image" content="https://dmachard.github.io/"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><link href=/posts/index.xml rel=alternate type=application/rss+xml title="My technical gists"></head><body><div class=application-main><main><div class="mt-0 position-sticky top-0 d-none d-md-block bg-white width-full color-border-secondary" style=z-index:3><div class="container-xl px-3 px-md-4 px-lg-5"><div class="gutter-condensed gutter-lg flex-column flex-md-row d-flex"><div class="flex-shrink-0 col-12 col-md-3 mb-4 mb-md-0"><div class="vcard-names-container float-left col-10 col-md-12 pt-1 pt-md-3 pb-1 pb-md-3 js-sticky js-user-profile-sticky-fields" data-original-top=0px style=position:sticky><h1 class="vcard-names pl-2 pl-md-0"><span class="p-name vcard-fullname d-block overflow-hidden">Denis Machard</span>
<span class="p-nickname vcard-username d-block">My technical gists</span></h1></div></div><div class="flex-shrink-0 col-12 col-md-9 mb-4 mb-md-0"><div class="UnderlineNav width-full border-bottom box-shadow-none hx_UnderlineNav-with-profile-color-modes-banner"><nav class=UnderlineNav-body><a class=UnderlineNav-item href=https://dmachard.github.io/><svg class="octicon octicon-pin UnderlineNav-octicon hide-sm" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="m11.294.984 3.722 3.722a1.75 1.75.0 01-.504 2.826l-1.327.613a3.089 3.089.0 00-1.707 2.084l-.584 2.454c-.317 1.332-1.972 1.8-2.94.832L5.75 11.311 1.78 15.28A.749.749.0 11.72 14.22l3.969-3.97-2.204-2.204c-.968-.968-.5-2.623.832-2.94l2.454-.584a3.08 3.08.0 002.084-1.707l.613-1.327a1.75 1.75.0 012.826-.504zM6.283 9.723l2.732 2.731a.25.25.0 00.42-.119l.584-2.454a4.586 4.586.0 012.537-3.098l1.328-.613a.25.25.0 00.072-.404l-3.722-3.722a.25.25.0 00-.404.072l-.613 1.328A4.584 4.584.0 016.119 5.981l-2.454.584a.25.25.0 00-.119.42l2.731 2.732z"/></svg>Pinned</a>
<a class="UnderlineNav-item selected" href=https://dmachard.github.io//posts/><svg class="octicon octicon-repo UnderlineNav-octicon hide-sm" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M0 1.75A.75.75.0 01.75 1h4.253c1.227.0 2.317.59 3 1.501A3.744 3.744.0 0111.006 1h4.245a.75.75.0 01.75.75v10.5a.75.75.0 01-.75.75h-4.507a2.25 2.25.0 00-1.591.659l-.622.621a.75.75.0 01-1.06.0l-.622-.621A2.25 2.25.0 005.258 13H.75A.75.75.0 010 12.25V1.75zm8.755 3a2.25 2.25.0 012.25-2.25H14.5v9h-3.757c-.71.0-1.4.201-1.992.572l.004-7.322zm-1.504 7.324.004-5.073-.002-2.253A2.25 2.25.0 005.003 2.5H1.5v9h3.757a3.75 3.75.0 011.994.574z"/></svg>Gists
<span class=Counter>53</span></a>
<a class=UnderlineNav-item href=https://dmachard.github.io//tags/><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>Tags
<span class=Counter>70</span></a></nav></div></div></div></div></div><div class="container-xl px-3 px-md-4 px-lg-5"><div class="gutter-condensed gutter-lg flex-column flex-md-row d-flex"><div class="flex-shrink-0 col-12 col-md-3 mb-4 mb-md-0"><div class="h-card pt-4 pt-md-0"><div class="clearfix d-flex d-md-block flex-items-center mb-4 mb-md-0"><div class="position-relative d-inline-block col-2 col-md-12 mr-3 mr-md-0 flex-shrink-0" style=z-index:2><a href=https://dmachard.github.io/images/avatar.png><img style=height:auto alt=Avatar width=260 height=260 id=headerImg class="avatar avatar-user width-full border bg-white" src=https://dmachard.github.io/images/avatar.png></a></div><div class="vcard-names-container d-md-none float-left col-10 col-md-12 pt-1 pt-md-3 pb-1 pb-md-3 js-sticky js-user-profile-sticky-fields" data-original-top=0px style=position:sticky><h1 class="vcard-names pl-2 pl-md-0"><span class="p-name vcard-fullname d-block overflow-hidden">Denis Machard</span>
<span class="p-nickname vcard-username d-block">My technical gists</span></h1></div></div><div class="p-note user-profile-bio mt-3 js-user-profile-bio f4"><div>Infrastructure architect by profession but always consider himself as a developer and an open source enthusiast.</div></div><div class="d-flex flex-column mt-3"><div class="js-profile-editable-area d-flex flex-column d-md-block"><ul class=vcard-details><li class="vcard-detail pt-1 css-truncate css-truncate-target"><svg class="octicon octicon-mail" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M1.75 2A1.75 1.75.0 000 3.75v.736a.75.75.0 000 .027v7.737C0 13.216.784 14 1.75 14h12.5A1.75 1.75.0 0016 12.25v-8.5A1.75 1.75.0 0014.25 2H1.75zM14.5 4.07v-.32a.25.25.0 00-.25-.25H1.75a.25.25.0 00-.25.25v.32L8 7.88l6.5-3.81zm-13 1.74v6.441c0 .138.112.25.25.25h12.5a.25.25.0 00.25-.25V5.809L8.38 9.397a.75.75.0 01-.76.0L1.5 5.809z"/></svg><a class="u-email link-gray-dark" href=mailto:d.machard@gmail.com>d.machard@gmail.com</a></li></ul></div></div><div class="color-border-secondary pt-3 mt-3 clearfix hide-sm hide-md"><div style=display:flex;justify-content:flex-start;flex-wrap:wrap;margin-bottom:3px><a style="margin:0 10px 10px 0" href=https://github.com/dmachard><svg id="github-icon" viewBox="0 0 16 16" width="32" height="32" fill="#24292e"><path fill-rule="evenodd" d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.013 8.013.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a><a style="margin:0 10px 10px 0" href=https://fosstodon.org/@dmachard><img alt=@linkedin width=32 height=32 src=https://dmachard.github.io/images/mastodon.png class=avatar></a>
<a style="margin:0 10px 10px 0" href=https://dmachard.github.io/index.xml><img alt=@rss width=32 height=32 src=https://dmachard.github.io/images/rss.png class=avatar></a></div></div></div></div><div class="flex-shrink-0 col-12 col-md-9 mb-4 mb-md-0"><div class="UnderlineNav user-profile-nav d-block d-md-none position-sticky top-0 pl-3 ml-n3 mr-n3 pr-3 bg-white" style=z-index:3><nav class=UnderlineNav-body><a class=UnderlineNav-item href=https://dmachard.github.io/>Pinned</a>
<a class='UnderlineNav-item selected' href=https://dmachard.github.io//posts/>Gists
<span class=Counter>53</span></a>
<a class=UnderlineNav-item href=https://dmachard.github.io//tags/>Tags
<span class=Counter>53</span></a></nav></div><div class=position-relative><div class="pt-4 pt-md-0"><ul><li class="col-12 d-flex width-full mb-4 pb-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://dmachard.github.io/posts/0017-elk-installation-centos7/>ELK installation on CentOS 7</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4">This post details how to install ELK (ElasticSearch, Logstash, Kibana and also Filebeat) on CentOS7.
Table of contents ElastiscSearch Logstash Kibana Filebeat ElasticSearch Installation rpm --import https://artifacts.elastic.co/GPG-KEY-elasticsearch touch /etc/yum.repos.d/elasticsearch.repo vim /etc/yum.repos.d/elasticsearch.repo [elasticsearch] name=Elasticsearch repository for 7.x packages baseurl=https://artifacts.elastic.co/packages/7.x/yum gpgcheck=1 gpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch enabled=0 autorefresh=1 type=rpm-md yum install --enablerepo=elasticsearch elasticsearch systemctl daemon-reload systemctl enable elasticsearch.service Configuration vim /etc/elasticsearch/elasticsearch.yml network.host: 0.0.0.0 discovery.type: single-node Start the service systemctl start elasticsearch.service systemctl status elasticsearch.service Sanity check curl -X GET "localhost:9200" Logstash Installation with yum rpm --import https://artifacts.</div></div><div class="f6 text-gray mt-2">Created
<relative-time datetime=" Sun, 21 Jun 2020 00:00:00 +0100" class=no-wrap title=" Sun, 21 Jun 2020 00:00:00 +0100">Sun, 21 Jun 2020 00:00:00 +0100</relative-time>
<span class=file-info-divider></span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>elk</span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>logs</span></div></div></li><li class="col-12 d-flex width-full mb-4 pb-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://dmachard.github.io/posts/0020-powerdns-dnsdist-installation/>PowerDNS/dnsdist: installation guide on CentOS 7</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4">Table of contents Installation Configuration Start Firewalld configuration Installation Activate EPEL repo
yum install -y epel-release Install dependencies
yum install re2 net-snmp.x86_64 lmdb.x86_64 fstrm.x86_64 yum install protobuf.x86_64 tinycdb.x86_64 libsodium.x86_64 luajit.x86_64 openssl yum install gnutls tinycdb Download from the last version available https://repo.powerdns.com/centos/x86_64/7/
rpm -ivh dnsdist-1.4.0-1pdns.el7.rpm Configuration vim /etc/dnsdist/dnsdist.conf
-- bind on ip any setLocal('0.0.0.0:53') -- allow all IP access setACL({'0.0.0.0/0'}) -- start the web server on port 8080 webserver("0.0.0.0:8080", "key") -- disable security feature polling setSecurityPollSuffix('') -- log incoming request addAction(AllRule(), LogAction("/var/log/dnsdist.</div></div><div class="f6 text-gray mt-2">Created
<relative-time datetime=" Sun, 21 Jun 2020 00:00:00 +0100" class=no-wrap title=" Sun, 21 Jun 2020 00:00:00 +0100">Sun, 21 Jun 2020 00:00:00 +0100</relative-time>
<span class=file-info-divider></span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>dns</span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>powerdns</span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>dnsdist</span></div></div></li><li class="col-12 d-flex width-full mb-4 pb-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://dmachard.github.io/posts/0019-powerdns-rec-installation/>Recursor PowerDNS installation on CentOS</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4">PowerDNS recursor servers installation on CentOS.
Table of contents Installation Configuration Start server Cache purge entries Installation wget https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm yum -y install epel-release yum --enablerepo=epel install luajit libsodium yum --enablerepo=epel install jq curl -o /etc/yum.repos.d/powerdns-rec-43.repo https://repo.powerdns.com/repo-files/centos-rec-43.repo yum install pdns-recursor pdns-tools Configuration Recursor server configuration
/etc/pdns-recursor/recursor.conf local-address=0.0.0.0 local-port=53 security-poll-suffix= forward-zones=home.local=127.0.0.1:5300 forward-zones-recurse=.=10.0.0.140:53 Start server systemctl enable pdns-recursor.service systemctl start pdns-recursor.service Cache purge entries rec_control wipe-cache test1.home.local</div></div><div class="f6 text-gray mt-2">Created
<relative-time datetime=" Sun, 21 Jun 2020 00:00:00 +0100" class=no-wrap title=" Sun, 21 Jun 2020 00:00:00 +0100">Sun, 21 Jun 2020 00:00:00 +0100</relative-time>
<span class=file-info-divider></span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>dns</span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>powerdns</span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>recursor</span></div></div></li><li class="col-12 d-flex width-full mb-4 pb-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://dmachard.github.io/posts/0016-redhat-post-installation/>RedHat Family 8.x post installation</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4">Post installation tunning for RedHat system family.
Table of contents keyboard hostname configuration date, time and timezone minimal network configuration install minimal tools keyboard localectl set-keymap fr To confirm your permanent keymap settings execute the localectl command without any arguments
hostname configuration hostnamectl set-hostname &lt;mon nom de machine> date, time and timezone timedatectl set-timezone Europe/Paris timedatectl set-ntp yes/no timedatectl set-time [YYYY-MM-DD] timedatectl set-time [HH:MM:SS] timedatectl set-local-rtc yes/no minimal network configuration /etc/sysconfig/network-scripts/ifcfg-enp0s3 ONBOOT=yes BOOTPROTO=static PREFIX=24 IPADDR=192.</div></div><div class="f6 text-gray mt-2">Created
<relative-time datetime=" Sun, 21 Jun 2020 00:00:00 +0100" class=no-wrap title=" Sun, 21 Jun 2020 00:00:00 +0100">Sun, 21 Jun 2020 00:00:00 +0100</relative-time>
<span class=file-info-divider></span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>system</span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>redhat</span></div></div></li><li class="col-12 d-flex width-full mb-4 pb-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://dmachard.github.io/posts/0002-ntpd-logs-elk/>Ntpd: How to get statistics usage with ELK</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4">In this post, I will look at ntpd server to extract some ntp statitics.
Table of contents Activate ntpd logs peerstats documentation sysstats documentation Counting NTP clients Expected logs Export Logs to ELK Deploy Filebeat Configure Logstash Examples of dashboard on Kibana Activate ntpd logs Update the ntpd configuration
vim /etc/ntp.conf statsdir /var/log/ntpstats/ statistics peerstats sysstats filegen peerstats file peerstats.log type day enable filegen sysstats file sysstats.log type none enable Restart the daemon</div></div><div class="f6 text-gray mt-2">Created
<relative-time datetime=" Sat, 20 Jun 2020 00:00:00 +0100" class=no-wrap title=" Sat, 20 Jun 2020 00:00:00 +0100">Sat, 20 Jun 2020 00:00:00 +0100</relative-time>
<span class=file-info-divider></span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>ntp</span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>logs</span></div></div></li><li class="col-12 d-flex width-full mb-4 pb-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://dmachard.github.io/posts/0001-dnstap-testing/>Dnstap: How to enable it on main dns servers</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4">This post details how to enable the dnstap feature in main open source dns servers.
dnstap is a flexible, structured binary log format for DNS servers. It uses Protocol Buffers to encode DNS packets in events.
dnstap can encode any DNS messages with network informations like ip and port. It includes client queries and responses.
Table of contents Introduction ISC bind Build with dnstap support Unix socket TCP stream PowerDNS - pdns-recursor Unix socket TCP stream PowerDNS - dnsdist Unix socket TCP stream NLnetLabs - nsd Build with dnstap support Unix socket NLnetLabs - unbound Build with dnstap support Unix socket TCP stream TLS stream CoreDNS Unix socket TCP stream CZ-NIC - knot resolver Unix socket Introduction This dnstap feature has been tested with success with the following dns servers:</div></div><div class="f6 text-gray mt-2">Created
<relative-time datetime=" Sat, 23 May 2020 00:00:00 +0100" class=no-wrap title=" Sat, 23 May 2020 00:00:00 +0100">Sat, 23 May 2020 00:00:00 +0100</relative-time>
<span class=file-info-divider></span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>dns</span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>logs</span></div></div></li><li class="col-12 d-flex width-full mb-4 pb-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://dmachard.github.io/posts/0025-docker-container-debug-startup/>Docker: debug sur container ne démarrant pas</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4">Quelques commandes pour debugger un container qui ne démarre pas
How to Comment obtenir un shell dans un container?
docker exec -it &lt;container_id> bash Comment debugguer sur container qui démarre pas? en modifiant le entrypoint par sh ce qui permet ensuite d&rsquo;exécuter à la main le script ou programme posant problème.
docker run -it --name=&lt;moncontainer> --entrypoint=sh &lt;container_img> Comment afficher les logs d&rsquo;un container?
docker logs --follow &lt;container_id></div></div><div class="f6 text-gray mt-2">Created
<relative-time datetime=" Thu, 18 Jul 2019 00:00:00 +0100" class=no-wrap title=" Thu, 18 Jul 2019 00:00:00 +0100">Thu, 18 Jul 2019 00:00:00 +0100</relative-time>
<span class=file-info-divider></span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>docker</span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>debug</span></div></div></li><li class="col-12 d-flex width-full mb-4 pb-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://dmachard.github.io/posts/0031-pycnic-api-python/>Exemple de développement d'une API REST avec pycnic</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4">Exemple de développement d&rsquo;une API avec la librairie Python pycnic
Installation de la librarie
pip install pycnic Exemple simple d&rsquo;une API serveur:
from pycnic.core import WSGI, Handler from pycnic.errors import HTTP_401, HTTP_400, HTTP_500, HTTP_403, HTTP_404 from wsgiref.simple_server import make_server, WSGIServer from SocketServer import ThreadingMixIn class HandlerCors(Handler): def options(self): return {} class HelloWorld(HandlerCors): def post(self): return { "msg": "success" } class app(WSGI): headers = [ ("Access-Control-Allow-Origin", "*"), ("Access-Control-Allow-Method", "*"), ("Access-Control-Allow-Headers", "content-type, authorization"), ] routes = [ ('/helloworld', HelloWorld()) ] class ThreadingWSGIServer(ThreadingMixIn, WSGIServer): daemon_threads = True class Server: def __init__(self, wsgi_app, listen='127.</div></div><div class="f6 text-gray mt-2">Created
<relative-time datetime=" Sun, 03 Mar 2019 00:00:00 +0100" class=no-wrap title=" Sun, 03 Mar 2019 00:00:00 +0100">Sun, 03 Mar 2019 00:00:00 +0100</relative-time>
<span class=file-info-divider></span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>python</span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>api</span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>pynic</span></div></div></li><li class="col-12 d-flex width-full mb-4 pb-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://dmachard.github.io/posts/0030-docker-swarm-installation/>Installation d'un cluster docker swarm</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4">Procédure pour installer un clusteur docker swarm sur 3 machines.
En prerequis, installer docker-ce sur l&rsquo;ensemble des machines, le port tcp/2377 doit être ouvert.
sur le manager
docker swarm init --advertise-addr IP_MANAGER sur le worker
docker swarm join --token SWMTKN-1-1xgbk6rfab....k8048s IP_MANAGER:2377 sur manager ou worker
docker info sur un manager
docker node ls</div></div><div class="f6 text-gray mt-2">Created
<relative-time datetime=" Sat, 09 Feb 2019 00:00:00 +0100" class=no-wrap title=" Sat, 09 Feb 2019 00:00:00 +0100">Sat, 09 Feb 2019 00:00:00 +0100</relative-time>
<span class=file-info-divider></span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>docker</span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>swarm</span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>ha</span></div></div></li><li class="col-12 d-flex width-full mb-4 pb-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://dmachard.github.io/posts/0015-virtualbox-vm-boot/>Auto start Virtualbox VM on boot</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4">This post details how to start automatically a VM on boot.
Table of contents Guide Guide Create a shortcut.
Open virtualbox highlight the VM you want to startup click &ldquo;Machine&rdquo; -> &ldquo;Create Shortcut on Desktop&rdquo; Add to windows startup
Start -> Run type in &ldquo;shell:startup&rdquo; copy & paste shortcut in here.</div></div><div class="f6 text-gray mt-2">Created
<relative-time datetime=" Fri, 08 Feb 2019 00:00:00 +0100" class=no-wrap title=" Fri, 08 Feb 2019 00:00:00 +0100">Fri, 08 Feb 2019 00:00:00 +0100</relative-time>
<span class=file-info-divider></span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>vm</span>
<span class="muted-link mr-3"><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>windows</span></div></div></li></ul><div class=paginate-container><div class=BtnGroup><a rel=nofollow class="btn btn-outline BtnGroup-item" href=/posts/page/4/>Previous</a>
<a rel=nofollow class="btn btn-outline BtnGroup-item" href=/posts/page/6/>Next</a></div></div></div></div></div></div></div></main></div><div class="footer container-xl width-full p-responsive"><div class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light"><span>Propulsed by <a href=https://gohugo.io/>hugo</a> and <a href=https://github.com/dmachard/hugo-theme-gists>hugo-theme-gists</a></li></span></div></div></body><script type=application/javascript src=https://dmachard.github.io/js/lib.js></script></html>
<!doctype html><html lang=en-US><head><meta charset=utf-8><meta name=viewport content="width=device-width"><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9 crossorigin=anonymous><link rel=stylesheet href=https://dmachard.github.io/css/gists.css><title>Authoritary PowerDNS installation on CentOS - My technical gists</title><link rel=icon type=image/x-icon href=/images/avatar.png><meta name=theme-color content="#1e2327"><meta name=description content="PowerDNS authoritary servers installation procedure"><meta name=keywords content="blog,technical"><meta name=robots content="noodp"><link rel=canonical href=https://dmachard.github.io/posts/0018-powerdns-installation/><meta name=twitter:card content="summary"><meta name=twitter:title content="Authoritary PowerDNS installation on CentOS - My technical gists"><meta name=twitter:description content="PowerDNS authoritary servers installation procedure"><meta name=twitter:site content="https://dmachard.github.io"><meta name=twitter:creator content><meta name=twitter:image content="https://dmachard.github.io"><meta property="og:type" content="article"><meta property="og:title" content="Authoritary PowerDNS installation on CentOS - My technical gists"><meta property="og:description" content="PowerDNS authoritary servers installation procedure"><meta property="og:url" content="https://dmachard.github.io/posts/0018-powerdns-installation/"><meta property="og:site_name" content="Authoritary PowerDNS installation on CentOS"><meta property="og:image" content="https://dmachard.github.io"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2020-06-21 00:00:00 +0100 +0100"></head><body><main><div class=container-xl><div class="d-flex flex-sm-row flex-column"><div class="p-2 pt-0 col-sm-3"><div class="d-flex flex-column sticky-top"><div class="d-flex flex-sm-column"><div class="pt-3 pt-md-2 pb-2 order-sm-1 order-2"><p class="fs-4 fw-bold p-0 m-0">Denis Machard</p><p class="fs-5 text-dark-emphasis">My technical gists</p></div><div class="pt-2 pe-2 col-3 col-sm-12 order-sm-2 order-1"><a href=/images/profile.png><img width=250 class="img-thumbnail rounded-pill border bg-white" src=/images/profile.png></a></div></div><div class="mt-3 fs-6 text-dark-emphasis">Infrastructure background, developer mindset. I build things for pleasure.</div><div class=pt-3><ul class=list-unstyled></ul></div><div class="pt-3 pb-4"><a style="margin:0 10px 10px 0" href=https://github.com/dmachard><img alt=@github width=32 height=32 src=https://dmachard.github.io/images/github.png></a>
<a style="margin:0 10px 10px 0" href=https://fosstodon.org/@dmachard><img alt=@mastodon width=32 height=32 src=https://dmachard.github.io/images/mastodon.png></a>
<a style="margin:0 10px 10px 0" href=https://dmachard.github.io/index.xml><img alt=@rss width=32 height=32 src=https://dmachard.github.io/images/rss.png></a></div></div></div><div class="p-2 pt-0 col-sm-9"><ul class="nav nav-underline sticky-top d-flex pt-2 mb-md-4 bg-white border-bottom"><li class="nav-item px-md-1"><a class='nav-link text-dark active' href=https://dmachard.github.io/posts/><svg height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M0 1.75A.75.75.0 01.75 1h4.253c1.227.0 2.317.59 3 1.501A3.744 3.744.0 0111.006 1h4.245a.75.75.0 01.75.75v10.5a.75.75.0 01-.75.75h-4.507a2.25 2.25.0 00-1.591.659l-.622.621a.75.75.0 01-1.06.0l-.622-.621A2.25 2.25.0 005.258 13H.75A.75.75.0 010 12.25V1.75zm8.755 3a2.25 2.25.0 012.25-2.25H14.5v9h-3.757c-.71.0-1.4.201-1.992.572l.004-7.322zm-1.504 7.324.004-5.073-.002-2.253A2.25 2.25.0 005.003 2.5H1.5v9h3.757a3.75 3.75.0 011.994.574z"/></svg><span class=m-1>Gists</span>
<span class="badge fw-normal bg-secondary bg-opacity-25 text-opacity-50 rounded-pill text-dark-emphasis">59</span></a></li><li class="nav-item px-md-1"><a class="nav-link text-dark-emphasis" href=https://dmachard.github.io/pinned/><svg height="16" viewBox="0 0 16 16" width="16"><path class="me-1" fill-rule="evenodd" d="m11.294.984 3.722 3.722a1.75 1.75.0 01-.504 2.826l-1.327.613a3.089 3.089.0 00-1.707 2.084l-.584 2.454c-.317 1.332-1.972 1.8-2.94.832L5.75 11.311 1.78 15.28A.749.749.0 11.72 14.22l3.969-3.97-2.204-2.204c-.968-.968-.5-2.623.832-2.94l2.454-.584a3.08 3.08.0 002.084-1.707l.613-1.327a1.75 1.75.0 012.826-.504zM6.283 9.723l2.732 2.731a.25.25.0 00.42-.119l.584-2.454a4.586 4.586.0 012.537-3.098l1.328-.613a.25.25.0 00.072-.404l-3.722-3.722a.25.25.0 00-.404.072l-.613 1.328A4.584 4.584.0 016.119 5.981l-2.454.584a.25.25.0 00-.119.42l2.731 2.732z"/></svg><span class=m-1>Pinned</span>
<span class="badge fw-normal bg-secondary bg-opacity-25 text-opacity-50 rounded-pill text-dark-emphasis">5</span></a></li><li class="nav-item px-md-1"><a class='nav-link text-dark-emphasis' href=https://dmachard.github.io/tags/><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg><span class=m-1>Tags</span>
<span class="badge fw-normal bg-secondary bg-opacity-25 text-opacity-50 rounded-pill text-dark-emphasis">49</span></a></li></ul><div class="d-flex flex-column border rounded mt-4 mt-md-0"><div class="border-bottom bg-light markdown-sticky-top"><div class="d-flex flex-row align-items-center"><div class=btn-group role=group><button type=button class=btn data-bs-toggle=dropdown aria-expanded=false><svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16"><path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zm0 5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zm0 5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zM3 8A1 1 0 111 8a1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"/></svg></button><ul class=dropdown-menu id=toc-list><li><h6 class=dropdown-header>Table of Content</h6></li></ul></div><div class="flex-fill text-secondary fs-7"><relative-time datetime="Sun, 21 Jun 2020 00:00:00 +0100"></relative-time></div><div class="pe-2 d-none d-md-block"><a class="badge text-bg-secondary text-dark fw-normal bg-opacity-25 pb-1 link-underline link-underline-opacity-0 link-underline-opacity-100-hover" href=/tags/dns>dns</a>
<a class="badge text-bg-secondary text-dark fw-normal bg-opacity-25 pb-1 link-underline link-underline-opacity-0 link-underline-opacity-100-hover" href=/tags/powerdns>powerdns</a></div></div></div><div class="pt-4 px-2 pb-3"><article class="markdown-body container-lg"><h1 id=authoritary-powerdns-installation-on-centos>Authoritary PowerDNS installation on CentOS</h1><p>PowerDNS authoritary servers installation on *<em>CentOS 7</em> with <strong>sqlite</strong> database</p><h2 id=installation><a class=anchor href=#installation>Installation</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
</span></span><span style=display:flex><span>yum -y install epel-release
</span></span><span style=display:flex><span>yum --enablerepo<span style=color:#f92672>=</span>epel install luajit libsodium
</span></span><span style=display:flex><span>yum --enablerepo<span style=color:#f92672>=</span>epel install jq
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>curl -o /etc/yum.repos.d/powerdns-auth-42.repo https://repo.powerdns.com/repo-files/centos-auth-42.repo
</span></span><span style=display:flex><span>yum install pdns pdns-tools pdns-backend-sqlite
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>wget https://raw.githubusercontent.com/PowerDNS/pdns/master/modules/gsqlite3backend/schema.sqlite3.sql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mkdir /var/db/pdns
</span></span><span style=display:flex><span>sqlite3 /var/db/pdns/pdns.db
</span></span><span style=display:flex><span>.read schema.sqlite3.sql
</span></span><span style=display:flex><span>.quit
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>chown -R pdns:pdns /var/db/pdns
</span></span></code></pre></div><h2 id=configuration><a class=anchor href=#configuration>Configuration</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vim /etc/pdns/pdns.conf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>version-string<span style=color:#f92672>=</span>anonymous
</span></span><span style=display:flex><span>setuid<span style=color:#f92672>=</span>pdns
</span></span><span style=display:flex><span>setgid<span style=color:#f92672>=</span>pdns
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>local-ipv6<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>launch<span style=color:#f92672>=</span>gsqlite3
</span></span><span style=display:flex><span>gsqlite3-database<span style=color:#f92672>=</span>/var/db/pdns/pdns.db
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>webserver<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>webserver-address<span style=color:#f92672>=</span>0.0.0.0
</span></span><span style=display:flex><span>webserver-port<span style=color:#f92672>=</span><span style=color:#ae81ff>8081</span>
</span></span><span style=display:flex><span>webserver-allow-from<span style=color:#f92672>=</span>127.0.0.0/8,10.0.0.0/24
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>api<span style=color:#f92672>=</span>on
</span></span><span style=display:flex><span>api-key<span style=color:#f92672>=</span>test
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>master<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>dnsupdate<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>local-address<span style=color:#f92672>=</span>0.0.0.0
</span></span><span style=display:flex><span>local-port<span style=color:#f92672>=</span><span style=color:#ae81ff>5300</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>log-dns-details<span style=color:#f92672>=</span>on
</span></span><span style=display:flex><span>log-dns-queries<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>log-timestamp<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>loglevel<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>security-poll-suffix<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>allow-dnsupdate-from<span style=color:#f92672>=</span>
</span></span></code></pre></div><h2 id=start-server><a class=anchor href=#start-server>Start server</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>systemctl enable pdns.service
</span></span><span style=display:flex><span>systemctl start pdns.service
</span></span></code></pre></div><h2 id=manage-configuration><a class=anchor href=#manage-configuration>Manage configuration</a></h2><p>Manage configuration with pdnsutil command</p><ul><li>Add a new zone</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdnsutil create-zone home.local
</span></span><span style=display:flex><span>pdnsutil create-zone home.local ns1.home.local
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pdnsutil add-record home.local ns1 A <span style=color:#ae81ff>3600</span> 10.0.0.71
</span></span></code></pre></div><ul><li>Add a new resource record</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdnsutil add-record home.local ea A <span style=color:#ae81ff>300</span> 10.0.0.72
</span></span></code></pre></div><ul><li>List all zones</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdnsutil list-all-zones
</span></span></code></pre></div><ul><li>Delete a zone</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdnsutil delete-zone home.local
</span></span></code></pre></div><ul><li>Delete a resource record</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdnsutil delete-rrset home.local ea A
</span></span></code></pre></div><ul><li>Update resource record</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdnsutil replace-rrset home.local ea A <span style=color:#ae81ff>3600</span> 10.0.0.1
</span></span></code></pre></div><ul><li>Edit a zone</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export EDITOR<span style=color:#f92672>=</span>vim
</span></span><span style=display:flex><span>pdnsutil edit-zone home.local
</span></span></code></pre></div><h2 id=cache-purge-entries><a class=anchor href=#cache-purge-entries>Cache purge entries</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdns_control purge test1.home.local
</span></span></code></pre></div><h2 id=dns-update-rfc2136><a class=anchor href=#dns-update-rfc2136>DNS-UPDATE (RFC2136)</a></h2><h3 id=activation><a class=anchor href=#activation>Activation</a></h3><ul><li>Generate the tsig key for the domain to securize</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdnsutil generate-tsig-key homelocal_update hmac-md5
</span></span></code></pre></div><ul><li>Activate the key in the domain</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdnsutil set-meta home.local TSIG-ALLOW-DNSUPDATE homelocal_update
</span></span></code></pre></div><ul><li>Authorize just some network to make update in the zone</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdnsutil set-meta home.local ALLOW-DNSUPDATE-FROM 10.0.0.0/24
</span></span></code></pre></div><ul><li>Activate notification to slave server on each update</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdnsutil set-meta home.local NOTIFY-DNSUPDATE <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><ul><li>Display all TSIG keys</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdnsutil list-tsig-keys
</span></span></code></pre></div><h3 id=testing-dns-update><a class=anchor href=#testing-dns-update>Testing DNS UPDATE</a></h3><ul><li>Create the file dnsupdate.txt with the following content</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>server &lt;pdns_ip_address&gt; &lt;pdns_port&gt;
</span></span><span style=display:flex><span>zone home.local
</span></span><span style=display:flex><span>update add test1.home.local <span style=color:#ae81ff>3600</span> A 10.0.0.140
</span></span><span style=display:flex><span>key &lt;key_name&gt; &lt;tsig_key&gt;
</span></span><span style=display:flex><span>show
</span></span><span style=display:flex><span>send
</span></span></code></pre></div><ul><li>Execute the nsupdate command to make the update in the zone</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nsupdate -v dnsupdate.txt
</span></span></code></pre></div><h2 id=gslb-feature><a class=anchor href=#gslb-feature>GSLB feature</a></h2><ul><li>Update the configuration to activate LUA</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>enable-lua-records<span style=color:#f92672>=</span>yes
</span></span></code></pre></div><ul><li>Return time with TXT type</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdnsutil add-record time.gslb.test time LUA <span style=color:#ae81ff>0</span> <span style=color:#e6db74>&#39;TXT &#34;os.date()&#34;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>dig @10.0.0.235 -t txt time.gslb.test +short
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;Mon Oct 14 16:05:06 2019&#34;</span>
</span></span></code></pre></div><ul><li>Return random IP with round robin</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdnsutil add-record gslb.test roundrobin LUA <span style=color:#ae81ff>0</span> <span style=color:#e6db74>&#34;A 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>\&#34;pickrandom({&#39;10.0.0.1&#39;,&#39;10.0.0.2&#39;,&#39;10.0.0.3&#39;,&#39;10.0.0.4&#39;})\&#34;&#34;</span>
</span></span></code></pre></div><ul><li>Return specific IP accord to the result of TCP monitor. If all backends are down, then the complete list is returned otherwhise just one server is returned in random mode.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdnsutil add-record gslb.test tcp LUA <span style=color:#ae81ff>0</span> <span style=color:#e6db74>&#34;A 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>\&#34;ifportup(80,{&#39;10.0.0.1&#39;, &#39;10.0.0.2&#39;}, {selector=&#39;random&#39;,backupSelector=&#39;all&#39;})\&#34;&#34;</span>
</span></span></code></pre></div><ul><li>Return specific IP accord to the result of HTTP monitor. An URL is currently considered UP if the HTTP response codeis equal to 200. The checks are performed sequentially, with aminimum delay of 5 seconds.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdnsutil add-record gslb.test http LUA <span style=color:#ae81ff>0</span> <span style=color:#e6db74>&#34;A 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>\&#34;ifurlup(&#39;http://home.local&#39;, {&#39;10.0.0.1&#39;,&#39;10.0.0.2&#39;}, 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{selector=&#39;random&#39;, backupSelector=&#39;all&#39;,stringmatch=&#39;UP&#39;})\&#34;&#34;</span>
</span></span></code></pre></div><h2 id=play-with-rest-api><a class=anchor href=#play-with-rest-api>Play with REST API</a></h2><ul><li>Get all zones</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -s -H <span style=color:#e6db74>&#39;X-API-Key: dns&#39;</span> http://127.0.0.1:8082/api/v1/servers/localhost
</span></span></code></pre></div><ul><li>Get a specific zone</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -s -H <span style=color:#e6db74>&#39;X-API-Key: dns&#39;</span> http://127.0.0.1:8082/api/v1/servers/localhost/zones/home.local
</span></span></code></pre></div><ul><li>Generate a TSIG key</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -s -X POST -H <span style=color:#e6db74>&#34;X-API-Key: dns&#34;</span> -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> 
</span></span><span style=display:flex><span>-d <span style=color:#e6db74>&#39;{&#34;name&#34;: &#34;mytsigkey2&#34;, &#34;algorithm&#34;: &#34;hmac-sha256&#34;}&#39;</span> 
</span></span><span style=display:flex><span>http://127.0.0.1:8082/api/v1/servers/localhost/tsigkeys
</span></span></code></pre></div><ul><li>Get metadata for a specific zone</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -s -H <span style=color:#e6db74>&#39;X-API-Key: dns&#39;</span> http://127.0.0.1:8082/api/v1/servers/localhost/zones/home.local/metadata
</span></span></code></pre></div><ul><li>Delete metadata</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -s -X DELETE -H <span style=color:#e6db74>&#39;X-API-Key: dns&#39;</span>
</span></span><span style=display:flex><span>http://127.0.0.1:8082/api/v1/servers/localhost/zones/home.local/metadata/ALLOW-DNSUPDATE-FROM
</span></span></code></pre></div><ul><li>Add metadata</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -s -X POST -H <span style=color:#e6db74>&#39;X-API-Key: dns&#39;</span> -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#e6db74>&#34;@restapi_metadata.json&#34;</span>
</span></span><span style=display:flex><span>http://127.0.0.1:8082/api/v1/servers/localhost/zones/home.local/metadata
</span></span></code></pre></div><ul><li>Update RR</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -s -X PATCH -H <span style=color:#e6db74>&#34;X-API-Key: dns&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;rrsets&#34;: [{&#34;name&#34;: &#34;test1.home.local.&#34;, &#34;type&#34;: &#34;A&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;changetype&#34;: &#34;REPLACE&#34;, &#34;records&#34;: [{&#34;content&#34;: &#34;3.100.10.72&#34;, &#34;disabled&#34;: false}],
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;ttl&#34;: 3600}]}&#39;</span> http://10.0.0.235:8082/api/v1/servers/localhost/zones/home.local.
</span></span></code></pre></div></article></div></div></div></div></div></main><div class=container-xl><div class="pt-6 text-secondary border-top"><span>propulsed by
<a class="link-primary link-underline link-underline-opacity-0 link-underline-opacity-100-hover link-offset-2-hover" href=https://gohugo.io/>hugo</a>
and
<a class="link-primary link-underline link-underline-opacity-0 link-underline-opacity-100-hover link-offset-2-hover" href=https://github.com/dmachard/hugo-theme-gists>hugo-theme-gists</a></span></div></div></body><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js integrity=sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL crossorigin=anonymous></script>
<script type=application/javascript src=https://dmachard.github.io/js/gists.js></script></html>